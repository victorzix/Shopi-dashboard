<hlm-dialog-content *brnDialogContent="let ctx" class="min-w-[50rem]">
  <hlm-dialog-header>
    <h3 hlmDialogTitle hlm>
      <span
        *ngIf="!isEditingTitle"
        class="text-orange-600"
        (click)="editTitle()"
      >
        {{ category.name }}
      </span>
      <form *ngIf="isEditingTitle" [formGroup]="updateCategoryForm">
        <div hlmInputWrapper class="relative w-2/6">
          <hlm-spinner
            *ngIf="isUpdateLoading"
            class="absolute right-3 top-3 w-4 h-4"
          />
          <button
            *ngIf="!isUpdateLoading"
            class="absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 hover:scale-110 cursor-pointer transition-all duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"
            [disabled]="
              updateCategoryForm.controls.name.pristine ||
              updateCategoryForm.controls.name.invalid
            "
            (click)="confirmTitleEdit()"
          >
            <ng-icon name="lucideCheckCheck" />
          </button>
          <ng-icon
            *ngIf="!isUpdateLoading"
            name="lucideX"
            class="absolute right-9 top-1/2 -translate-y-1/2 w-5 h-5 hover:scale-110 hover:rotate-90 cursor-pointer transition-all duration-300 ease-in-out"
            (click)="cancelTitleEdit()"
          />
          <input
            type="text"
            class="text-sm w-full p-2 pr-15 border border-gray-300 rounded-md"
            formControlName="name"
            hlmInput
            [ngClass]="{
              'border-red-500':
                updateCategoryForm.controls.name.invalid &&
                updateCategoryForm.controls.name.touched
            }"
            [(ngModel)]="category.name"
          />
        </div>
      </form>
    </h3>
  </hlm-dialog-header>
  <div class="w-full px-3">
    <h3 class="font-bold">Descrição da categoria</h3>
    <p *ngIf="!isEditingDescription" (click)="editDescription()">
      {{ category.description }}
    </p>
    <form *ngIf="isEditingDescription" [formGroup]="updateCategoryForm">
      <div hlmInputWrapper class="relative w-full">
        <hlm-spinner
          *ngIf="isUpdateLoading"
          class="absolute right-5 bottom-3 w-4 h-4"
        />
        <button
          *ngIf="!isUpdateLoading"
          class="absolute text-xl flex items-end right-3 bottom-0 -translate-y-1/2 hover:scale-110 cursor-pointer transition-all duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed"
          [disabled]="
            updateCategoryForm.controls.description.pristine ||
            updateCategoryForm.controls.description.invalid
          "
          [attr.disabled]="
            updateCategoryForm.controls.description.pristine ? true : null
          "
          (click)="confirmDescriptionEdit()"
        >
          <ng-icon name="lucideCheckCheck" />
        </button>
        <ng-icon
          *ngIf="!isUpdateLoading"
          name="lucideX"
          class="absolute text-xl right-9 bottom-0 -translate-y-1/2 text-gray-500 hover:scale-110 hover:rotate-90 cursor-pointer transition-all duration-300 ease-in-out"
          (click)="cancelDescriptionEdit()"
        />
        <textarea
          type="text"
          class="text-sm p-2 w-full min-h-25 border border-gray-300 rounded-md"
          formControlName="description"
          [(ngModel)]="category.description"
          hlmInput
        ></textarea>
      </div>
    </form>
  </div>

  <div class="px-3 flex flex-col gap-3">
    <h3 class="font-bold text-orange-600">Subcategorias</h3>
    <div class="cursor-default w-full flex flex-wrap gap-1 items-center">
      <ng-container *ngIf="subCategories && subCategories.length > 0">
        <div
          class="w-6 h-6 rounded-full cursor-pointer hover:bg-orange-500 transition-all ease-in-out duration-200 hover:scale-110 bg-orange-600 text-white flex items-center justify-center text-sm"
          [brnMenuTriggerFor]="createSubCategoryMenu"
        >
          +
        </div>
      </ng-container>

      <ng-container *ngIf="!isSubCategoriesLoading; else skeleton">
        <ng-container
          *ngIf="subCategories && subCategories.length; else emptyState"
        >
          <div
            class="bg-orange-500 hover:bg-orange-600"
            *ngFor="let sub of subCategories; let i = index"
            hlmBadge
            [brnMenuTriggerFor]="subCategoryMenu"
          >
            {{ sub.name }}

            <ng-template #subCategoryMenu>
              <hlm-menu class="w-56">
                <hlm-menu-group>
                  <hlm-menu-label>{{ sub.description }}</hlm-menu-label>
                </hlm-menu-group>
                <hlm-menu-separator />
              </hlm-menu>
            </ng-template>
          </div>
        </ng-container>
      </ng-container>
    </div>
    <ng-template #skeleton>
      <hlm-skeleton
        *ngFor="let _ of [].constructor(8); let i = index"
        class="bg-gray-300 h-6 w-16 rounded-full"
      />
    </ng-template>

    <ng-template #emptyState>
      <div class="w-full flex flex-col justify-center items-center py-2 gap-2">
        <span class="text-gray-500 italic"
          >Nenhuma subcategoria encontrada.</span
        >
        <div
          class="w-12 h-12 rounded-full cursor-pointer hover:bg-orange-500 transition-all ease-in-out duration-200 hover:scale-110 bg-orange-600 text-white flex items-center justify-center text-lg"
          [brnMenuTriggerFor]="createSubCategoryMenu"
        >
          +
        </div>
      </div>
    </ng-template>
  </div>
</hlm-dialog-content>

<ng-template #createSubCategoryMenu>
  <hlm-menu class="w-56">
    <hlm-menu-group>
      <hlm-menu-label></hlm-menu-label>
    </hlm-menu-group>
    <hlm-menu-separator />
  </hlm-menu>
</ng-template>
